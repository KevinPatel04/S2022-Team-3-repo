{% extends 'template.html' %}
{% load static %}

{% block title %}
Volunteer Registration
{% endblock %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/form.css' %}">
{% endblock %}

{% block main %}
<div class ="container-fluid p-0 m-0">
    <div class="d-flex justify-content-md-center justify-content-sm-start">
        <h1 class="h1">Become a Volunteer</h1>
    </div>
    <div class="d-flex justify-content-md-center justify-content-sm-start">
        <div class = "row">
            <div class="col-md-11">
                <p>You need to answer all the questions below inorder to submit your application successfully</p>
                <form method="POST">

                    {% csrf_token %}

                    <div id="questions-wrapper">
                        
                    </div>
                    
                    <div class="form-group mb-2">
                        <label for="essay-1"><b>Why do you want to become a greenCan Volunteer? <small>(max 500 chars.)</small></b></label>
                        <textarea class="form-control" name="essay-1" required id="essay-1" maxlength="500"></textarea>
                    </div>
                    <div class="form-group mb-3">
                        <label for="essay-2"><b>Why do you belive that our mission is important? <small>(max 500 chars.)</small></b></label>
                        <textarea class="form-control" name="essay-2" required id="essay-2" maxlength="500"></textarea>
                    </div>
                    <div class="custom-control custom-checkbox mb-3">
                        <input type="checkbox" class="custom-control-input" id="consent" name="consent" required value="consent">
                        <label class="custom-control-label" for="consent">I agree with all the Terms & Conditions of greenCan, and I will well and faithfully discharge the duties of a greenCan Volunteer.</label>
                    </div>
                    <input type="submit" value="Submit" name="submit" class="button btn-rounded">
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{% include 'sweetalert2.html' %}
<script>

    function makeQuestion(question) {
        var div = document.createElement('div');
        div.classList = 'form-group';
        var label = document.createElement('label');
        label.setAttribute('for',`question#${question['id']}`);
        div.appendChild(label);
        $.each(question['choices'], function(choice){
            var input = document.createElement('input');
        });
        return div;
    }

    function addQuestions(questions) {
        var wrapper = $('#questions-wrapper');
        $.each(questions, function(question) {
            console.log(question);
            wrapper.append(makeQuestion(question));
        });
    }

    $(document).ready(function(){
        $.post({
            url: "{% url 'accounts:fetch-questions' %}",
            dataType: "json",
            success: function(data) {
                if(data.length > 0){
                    addQuestions(data);
                }
            },
            error: function(e) {
                Swal.fire({
                    title:'Error Occured!',
                    text: `Please try again later.`,
                    icon:'error',
                    confirmButtonColor:'#6ABE52',
                });  
            }
        });
    });

</script>
{% endblock %}
